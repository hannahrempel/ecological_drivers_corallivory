draw_image(orbicella_image, x = -0.385, y = 0.255, scale=0.07)+
draw_image(branching_porties_image, x = -0.019, y = 0.375, scale=0.09)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.255, scale=0.09)+
draw_image(orbicella_image, x = 0.1, y = 0.255, scale=0.07)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.255, scale=0.09)+
draw_image(orbicella_image, x = 0.1, y = 0.255, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.255, scale=0.09)+
draw_image(orbicella_image, x = 0.05, y = 0.255, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.255, scale=0.09)+
draw_image(orbicella_image, x = 0.07, y = 0.255, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.255, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.255, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.205, y = 0.38, scale=0.07)+
draw_image(siderastrea_image, x = 0.43, y = 0.38, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.2, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = -0.2, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = 0.2, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0.2, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = 0, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.05, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.09, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.12, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.15, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.14, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = 0, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = -0.135, scale=0.06)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.075)+
draw_image(siderastrea_image, x = 0.08, y = -0.134, scale=0.065)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.075)+
draw_image(siderastrea_image, x = 0.08, y = -0.133, scale=0.062)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.075)+
draw_image(siderastrea_image, x = 0.08, y = -0.132, scale=0.062)
corallivory_by_diversity_fig_final
corrected_transect_level_corallivory
corallivory_by_diversity_fig <- corrected_transect_level_corallivory %>%
mutate(region= factor(region, levels = c("Panamá", "Florida",  "St. Croix", "Bonaire"))) %>%
ggplot(aes(x=pct_coral_cover, y=n_colonies_grazed, color=region))+
geom_point()+
scale_y_continuous(breaks = c(0,2,4,6,8,10),
labels= c(0,2,4,6,8,10),
limits=c(0,10.2))+
theme_bw()+
scale_color_manual(values=region_palette)+
scale_fill_manual(values=region_palette)+
facet_wrap(~coral_species)+
labs(x = "Coral diversity (H')",
y = expression(paste("Colonies grazed per 30 m" ^2)),
color="Region",
fill="Region")+
theme_bw()+
theme(legend.position = "top")
corallivory_by_diversity_fig
corallivory_by_diversity_fig <- corrected_transect_level_corallivory %>%
mutate(region= factor(region, levels = c("Panamá", "Florida",  "St. Croix", "Bonaire"))) %>%
ggplot(aes(x=coral_diversity, y=n_colonies_grazed, color=region))+
geom_point()+
scale_y_continuous(breaks = c(0,2,4,6,8,10),
labels= c(0,2,4,6,8,10),
limits=c(0,10.2))+
theme_bw()+
scale_color_manual(values=region_palette)+
scale_fill_manual(values=region_palette)+
facet_wrap(~coral_species)+
labs(x = "Coral diversity (H')",
y = expression(paste("Colonies grazed per 30 m" ^2)),
color="Region",
fill="Region")+
theme_bw()+
theme(legend.position = "top")
#reading in coral genus icons
branching_porties_image <- magick::image_read(path=here("figures_tables/reef_images", "Branching_porties.png"), density = NULL, depth = NULL, strip = TRUE)
orbicella_image <- magick::image_read(path=here("figures_tables/reef_images", "Orbicella_annularis.png"), density = NULL, depth = NULL, strip = TRUE)
porites_astreoides_image <- magick::image_read(path=here("figures_tables/reef_images", "Porites_astreoides.png"), density = NULL, depth = NULL, strip = TRUE)
siderastrea_image <- magick::image_read(path=here("figures_tables/reef_images", "Siderastrea_siderea.png"), density = NULL, depth = NULL, strip = TRUE)
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.135, scale=0.075)+
draw_image(siderastrea_image, x = 0.08, y = -0.132, scale=0.062)
corallivory_by_diversity_fig_final
#saving figure
ggsave(plot=selectivity_combo_final, filename=here("supplements/fig_s1_selectivity_by_species.png"), width = 215, height = 110, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 110, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 180, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.05, scale=0.07)+
draw_image(siderastrea_image, x = 0.08, y = -0.05, scale=0.062)
corallivory_by_diversity_fig_final
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.08, scale=0.065)+
draw_image(siderastrea_image, x = 0.08, y = -0.08, scale=0.062)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.253, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.253, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.3, scale=0.09)+
draw_image(orbicella_image, x = 0.08, y = 0.28, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.33, scale=0.08)+
draw_image(orbicella_image, x = 0.08, y = 0.33, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.31, scale=0.08)+
draw_image(orbicella_image, x = 0.08, y = 0.31, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.31, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.31, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.081, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
corallivory_by_diversity_fig <- corrected_transect_level_corallivory %>%
mutate(region= factor(region, levels = c("Panamá", "Florida",  "St. Croix", "Bonaire"))) %>%
ggplot(aes(x=coral_diversity, y=n_colonies_grazed, color=region))+
geom_point(alpha=0.7)+
scale_y_continuous(breaks = c(0,2,4,6,8,10),
labels= c(0,2,4,6,8,10),
limits=c(0,10.2))+
theme_bw()+
scale_color_manual(values=region_palette)+
scale_fill_manual(values=region_palette)+
facet_wrap(~coral_species)+
labs(x = "Coral diversity (H')",
y = expression(paste("Colonies grazed per 30 m" ^2)),
color="Region",
fill="Region")+
theme_bw()+
theme(legend.position = "top")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.31, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.31, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
corallivory_by_diversity_fig <- corrected_transect_level_corallivory %>%
mutate(region= factor(region, levels = c("Panamá", "Florida",  "St. Croix", "Bonaire"))) %>%
ggplot(aes(x=coral_diversity, y=n_colonies_grazed, color=region))+
geom_point(alpha=0.6)+
scale_y_continuous(breaks = c(0,2,4,6,8,10),
labels= c(0,2,4,6,8,10),
limits=c(0,10.2))+
theme_bw()+
scale_color_manual(values=region_palette)+
scale_fill_manual(values=region_palette)+
facet_wrap(~coral_species)+
labs(x = "Coral diversity (H')",
y = expression(paste("Colonies grazed per 30 m" ^2)),
color="Region",
fill="Region")+
theme_bw()+
theme(legend.position = "top")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.31, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.31, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 215, height = 170, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 200, height = 150, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.30, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.30, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.1, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.098, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.098, scale=0.063)
corallivory_by_diversity_fig_final
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.095, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.096, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.1, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.096, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.12, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.11, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.113, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.11, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
corallivory_by_diversity_fig <- corrected_transect_level_corallivory %>%
mutate(coral_species=factor(coral_species, levels = c("Orbicella annularis", "Branching Porites spp.", "Porites astreoides", "Siderastrea siderea"))) %>%
mutate(region= factor(region, levels = c("Panamá", "Florida",  "St. Croix", "Bonaire"))) %>%
ggplot(aes(x=coral_diversity, y=n_colonies_grazed, color=region))+
geom_point(alpha=0.6)+
scale_y_continuous(breaks = c(0,2,4,6,8,10),
labels= c(0,2,4,6,8,10),
limits=c(0,10.2))+
theme_bw()+
scale_color_manual(values=region_palette)+
scale_fill_manual(values=region_palette)+
facet_wrap(~coral_species)+
labs(x = "Coral diversity (H')",
y = expression(paste("Colonies grazed per 30 m" ^2)),
color="Region",
fill="Region")+
theme_bw()+
theme(legend.position = "top")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(branching_porties_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(orbicella_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.113, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.11, scale=0.063)
corallivory_by_diversity_fig_final
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(orbicella_image, x = -0.385, y = 0.29, scale=0.08)+
draw_image(branching_porties_image, x = 0.081, y = 0.29, scale=0.075)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.113, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.11, scale=0.063)
corallivory_by_diversity_fig_final
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#adding coral images to figure (image placement is off in R, but good in ggsave generated png)
corallivory_by_diversity_fig_final <- cowplot::ggdraw() +
draw_plot(corallivory_by_diversity_fig)+ #adds the plot (order matters to overlay the layers correctly)
draw_image(orbicella_image, x = -0.385, y = 0.29, scale=0.075)+
draw_image(branching_porties_image, x = 0.081, y = 0.29, scale=0.08)+
draw_image(porites_astreoides_image, x = -0.385, y = -0.113, scale=0.062)+
draw_image(siderastrea_image, x = 0.08, y = -0.11, scale=0.063)
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s2_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
#scar abundance per colony with negative binomial distribution (without zero-inflation)
n_grazed_abundance_diversity_nbinom <- glmmTMB::glmmTMB(n_colonies_grazed ~ coral_species + coral_diversity+pct_coral_cover+ depth_m+region+
(1 | site/transect), #transects nested within sites within regions
zi=~0, #non zero-inflated
family=nbinom2(link = "log"),
data = corrected_transect_level_corallivory)
#testing for zero-inflation in negative binomial model: zero-inflation not significant
n_grazed_abundance_diversity_zero_inf_test<- DHARMa::testZeroInflation(n_grazed_abundance_diversity_nbinom)
#testing for zero-inflation in negative binomial model: zero-inflation not significant
n_grazed_abundance_diversity_zero_inf_test<- DHARMa::testZeroInflation(n_grazed_abundance_diversity_nbinom)
n_grazed_abundance_diversity_zero_inf_test
n_grazed_abundance_diversity_nbinom %>% summary()
#simulating residuals and testing
n_grazed_abundance_diversity_nbinom_residuals <- DHARMa::simulateResiduals(n_grazed_abundance_diversity_nbinom, n = 10000, use.u = T)
#simulating residuals and testing
n_grazed_abundance_diversity_nbinom_residuals <- DHARMa::simulateResiduals(n_grazed_abundance_diversity_nbinom, n = 10000, use.u = T)
DHARMa::testDispersion(n_grazed_abundance_diversity_nbinom_residuals, plot=FALSE) #no significant overdispersion
DHARMa::testDispersion(n_grazed_abundance_diversity_nbinom_residuals, plot=FALSE) #no significant overdispersion
plot(n_grazed_abundance_diversity_nbinom_residuals) #NS overdispersion, but potentially sig. outliers. Package message notes that binomial models may have inflated Type I error rates for interger-values distributions and recommends re-running testOutliers using type = "bootstrap"
n_grazed_abundance_diversity_nbinom %>% summary()
n_scars_col_level_ci <- confint(n_grazed_abundance_diversity_nbinom_residuals) %>%
as_tibble() %>%
select(-Estimate)
n_scars_col_level_ci <- confint(n_grazed_abundance_diversity_nbinom) %>%
as_tibble() %>%
select(-Estimate)
n_grazed_abundance_diversity_nbinom_ci <- confint(n_grazed_abundance_diversity_nbinom) %>%
as_tibble() %>%
select(-Estimate)
n_grazed_abundance_diversity_nbinom_ci
n_grazed_abundance_diversity_nbinom %>%
tidy() %>%
bind_cols(n_grazed_abundance_diversity_nbinom_ci)
#tidying model output
n_scars_col_level_model_output <- n_grazed_abundance_diversity_nbinom %>%
tidy() %>%
bind_cols(n_grazed_abundance_diversity_nbinom_ci) %>%
filter(effect!="ran_pars") %>%
janitor::clean_names() %>%
rename(ci_2.5 = x2_5_percent, ci_97.5=x97_5_percent) %>%
mutate(estimate_backtransformed = exp(estimate)) %>%
mutate(model="Colonies grazed") %>%
select(model, term, statistic, p_value, estimate, ci_2.5, ci_97.5, estimate_backtransformed) %>%
mutate(across(where(is.double), ~round(.x, 3))) %>%
mutate(term=str_replace(term, "coral_species", ""))
n_scars_col_level_model_output
#tidying model output
n_scars_col_level_model_output <- n_grazed_abundance_diversity_nbinom %>%
tidy() %>%
bind_cols(n_grazed_abundance_diversity_nbinom_ci) %>%
filter(effect!="ran_pars") %>%
janitor::clean_names() %>%
rename(ci_2.5 = x2_5_percent, ci_97.5=x97_5_percent) %>%
mutate(estimate_backtransformed = exp(estimate)) %>%
mutate(model="Colonies grazed") %>%
select(model, term, statistic, p_value, estimate, ci_2.5, ci_97.5, estimate_backtransformed) %>%
mutate(across(where(is.double), ~round(.x, 3))) %>%
mutate(term=str_replace(term, "coral_species", "")) %>%
mutate(term=str_replace(term, "region", ""))
n_scars_col_level_model_output
n_scars_col_level_model_output %>% filter(p_value<0.05)
n_scars_col_level_model_output
regional_parrotfish_coral_scar_summary
regional_coral_scar_patterns
fish_corals_site_level
fish_corals_site_level %>% filter(region=="Florida")
189.75275/25.04168
fish_corals_site_level %>% filter(region=="Florida")
92.59924/25.04168
fish_corals_site_level %>% filter(region=="Florida")
189.75275/25.04168
fish_corals_site_level %>% filter(region=="Florida")
0.4115389/0.2234353
fish_corals_site_level %>% filter(region=="Florida")
0.8831908/0.2234353
