facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 2.2, r = 0, b = 0.8, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm), position="stack", stat="identity")+
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm), position="stack", stat="identity"))+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 2.2, r = 0, b = 0.8, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 2.2, r = 0, b = 0.8, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 2.2, r = 0, b = 0.8, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm"))
plot.title = element_text(size = 12, face = "bold"),
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
#  plot.margin = margin(0.2, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0.01, 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
plot.margin = margin(0., 0.2, 0.2, 0.2, unit = "cm"),
strip.background = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.title.y = element_blank(),
axis.text.x = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
#  theme(strip.text.x = element_text(face = "bold", size = 10),
#        legend.text = element_text(face = "italic", size = 10),
#        axis.text = element_text(size = 10),
#        legend.position = "right")
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) +
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
pf_by_site_size_species_df
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
#ggsave(plot=figs1_pf_size_dist,
#       filename=here("supplements/fig_s1_parrotfish_density_by_size_species.jpg"),
#       width = 215, height = 200, dpi = 600, units = "mm")
#figs1_pf_size_dist
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=size_cm), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = parrotfish_size_palette) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = rev(parrotfish_size_palette)) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
ggsave(plot=figsx_pf_size_dist_by_site,
filename=here("supplements/fig_sx_parrotfish_density_by_size_site.jpg"),
width = 215, height = 200, dpi = 600, units = "mm")
figsx_pf_size_dist_by_site <- pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = rev(parrotfish_size_palette)) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
ggsave(plot=figsx_pf_size_dist_by_site,
filename=here("supplements/fig_sx_parrotfish_density_by_size_site.jpg"),
width = 215, height = 200, dpi = 600, units = "mm")
figsx_pf_size_dist_by_site
figs2_pf_size_dist_by_site <- pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = rev(parrotfish_size_palette)) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
ggsave(plot=figs2_pf_size_dist_by_site,
filename=here("supplements/fig_sx_parrotfish_density_by_size_site.jpg"),
width = 215, height = 200, dpi = 600, units = "mm")
figs2_pf_size_dist_by_site
figs2_pf_size_dist_by_site <- pf_by_site_size_df %>%
ggplot()+
geom_bar(aes(x=mean_pf_density_100m2, y=fct_rev(site), fill=fct_rev(size_cm)), position="stack", stat="identity")+
facet_grid(rows = vars(region), scales = "free_y", switch = "y", space = "free") +
labs(x= expression(paste("Major corallivores (n 100 ", m^-2, ")")), fill="Size (cm)", y="") +
xlim(0,3)+
theme_bw()+
scale_fill_manual(values = rev(parrotfish_size_palette)) +
scale_x_continuous(limits = c(0, 3), expand = c(0.025, 0)) + #removing extra white space on left
guides(fill=guide_legend(reverse=TRUE))+
theme(axis.title.x = element_text(margin = margin(t = 1.1, r = 0, b = 0, l = 0, unit = "mm")),
plot.title = element_text(size = 12, face = "bold"),
strip.text.y = element_text(angle = 270, face = "bold"),
strip.placement = "outside",
axis.title.y = element_blank(),
strip.text = element_text(size = 10, margin = margin(t = 1.5, r = 1.5, b = 1.5, l = 1.5, unit = "mm")),
axis.text = element_text(size = 10),
legend.position = "top")
ggsave(plot=fig_s2_pf_size_dist_by_site,
filename=here("supplements/fig_sx_parrotfish_density_by_size_site.jpg"),
width = 215, height = 200, dpi = 600, units = "mm")
ggsave(plot=figs2_pf_size_dist_by_site,
filename=here("supplements/fig_s2_parrotfish_density_by_size_site.jpg"),
width = 215, height = 200, dpi = 600, units = "mm")
figs2_pf_size_dist_by_site
#saving figure
ggsave(plot=selectivity_combo_final, filename=here("supplements/fig_s3_selectivity_by_species.png"), width = 215, height = 110, dpi = 600, units = "mm")
#saving figure
ggsave(plot=corallivory_by_diversity_fig_final, filename=here("supplements/fig_s4_corallivory_by_coral_diversity.png"), width = 190, height = 140, dpi = 600, units = "mm")
View(var_descriptors)
View(var_descriptors)
#the following if/require statements install packages if not already installed on your computer
if (!require(broom)) install.packages("broom")
if (!require(broom.mixed)) install.packages("broom.mixed")
if (!require(DHARMa)) install.packages("DHARMa")
if (!require(glmmTMB)) install.packages("glmmTMB")
if (!require(here)) install.packages("here")
if (!require(broom.mixed)) install.packages("janitor")
if (!require(tidyverse)) install.packages("tidyverse")
packages <- c("broom", "broom.mixed", "DHARMa", "glmmTMB", "haven", "here", "janitor", "tidyverse") #creates list of packages to load
sapply(packages, require, character.only = T) #loads library of packages
STARR_Test_Metadata <- read_csv(here("Data/Metadata_STARR_tests_2012_to_2022.csv")) %>%
janitor::clean_names()
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade3_english_2017_2018.sas7bdat")) %>%
janitor::clean_names()
var_descriptors <- tibble(col_name = label_df %>% names(),
col_description= label_df %>% map_chr(attr_getter("label")))
#combining test score data from 2017-18 to 2022-23 school years
raw_test_scores <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.sas7bdat$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names() #cleans variable names
scores_PortA_area <-raw_test_scores %>%
filter(dname %in% c("ARANSAS PASS IS", "CORPUS CHRISTI", "FLOUR BLUFF ISD", "PORT ARANSAS IS"))
glimpse(check)
glimpse(scores_PortA_area)
View(var_descriptors)
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade4_english_2017_2018.sas7bdat")) %>%
janitor::clean_names()
var_descriptors <- tibble(col_name = label_df %>% names(),
col_description= label_df %>% map_chr(attr_getter("label")))
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade4_english_2022_2023.sas7bdat")) %>%
janitor::clean_names()
var_descriptors <- tibble(col_name = label_df %>% names(),
col_description= label_df %>% map_chr(attr_getter("label")))
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade5_english_2022_2023.sas7bdat")) %>%
janitor::clean_names()
var_descriptors <- tibble(col_name = label_df %>% names(),
col_description= label_df %>% map_chr(attr_getter("label")))
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade8_english_2022_2023.sas7bdat")) %>%
janitor::clean_names()
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade8_english_2022_2023.sas7bdat")) %>%
janitor::clean_names()
#extracting descriptions of test score variables from of the SAS files
label_df <-haven::read_sas(here("data/raw_test_scores/grade8_english_2022_2023.sas7bdat")) %>%
janitor::clean_names()
var_descriptors <- tibble(col_name = label_df %>% names(),
col_description= label_df %>% map_chr(attr_getter("label")))
#combining test score data from 2017-18 to 2022-23 school years
raw_test_scores <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.sas7bdat$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names() #cleans variable names
test <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\grade_3$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
View(test)
test <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.grade_3$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
test
test <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.grade3$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
test
test <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.grade3_$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
test
test <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade3_",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
test
grade3 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade3_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
rawtest_grade5 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade5_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
rawtest_grade5 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade5_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
rawtest_grade6 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade6_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
rawtest_grade7 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade6_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
rawtest_grade8 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade8_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
View(rawtest_grade8)
View(rawtest_grade4)
rawtest_grade4 <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "^grade4_english",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.)) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names()
View(rawtest_grade4)
dim(raw_test_scores)
purrr::map_df(~haven::read_sas(.), descriptor=map_chr(attr_getter("label")) %>% #haven reads in SAS files, map_df combines them
#combining test score data from 2017-18 to 2022-23 school years
raw_test_scores <-
list.files(path = here("data/raw_test_scores/"), #lists all files in raw_test_scores with file paths
pattern = "\\.sas7bdat$",
full.names = T) %>%
purrr::map_df(~haven::read_sas(.), descriptor=map_chr(attr_getter("label"))) %>% #haven reads in SAS files, map_df combines them
janitor::clean_names() #cleans variable names
